/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => EthanUtil
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var BASIC_TEMPLATE = "Basic Template";
var INBOX_PATH = "Inbox";
var TASKS_PATH = "Tasks.md";
function currentDate() {
  return new Date().toISOString().slice(0, 10);
}
var EthanUtil = class extends import_obsidian.Plugin {
  async unique_note_contents() {
    const file = this.app.vault.getMarkdownFiles().find(
      (f) => f.basename == BASIC_TEMPLATE
    );
    if (file == null) {
      throw new Error("Can't find: " + BASIC_TEMPLATE);
    }
    let contents = await this.app.vault.cachedRead(file);
    contents = contents.replace(/{{date}}/g, currentDate());
    return contents;
  }
  async on_create(file) {
    const new_contents = await this.unique_note_contents();
    await new Promise((resolve) => setTimeout(resolve, 10));
    const old_content = await this.app.vault.read(file);
    if (/^---/.test(old_content)) {
      return;
    }
    this.app.vault.modify(file, new_contents + old_content);
  }
  async create_task() {
    const plugin = this.app.plugins.plugins["obsidian-tasks-plugin"];
    const task = await plugin.apiV1.createTaskLineModal();
    const file = this.app.vault.getAbstractFileByPath(TASKS_PATH);
    if (file instanceof import_obsidian.TFile) {
      this.app.vault.append(file, "\n" + task);
    } else {
      console.log("failed to find file for create_task");
    }
  }
  async append_task() {
    var _a;
    const editor = (_a = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView)) == null ? void 0 : _a.editor;
    if (editor == null) {
      return;
    }
    const cursor = editor.getCursor();
    const lineContent = editor.getLine(cursor.line);
    editor.replaceRange(
      "",
      { line: cursor.line, ch: 0 },
      { line: cursor.line + 1, ch: 0 }
    );
    const file = this.app.vault.getAbstractFileByPath(TASKS_PATH);
    if (file instanceof import_obsidian.TFile) {
      await this.app.vault.append(file, "\n" + lineContent);
    }
  }
  toggle_inbox() {
    let file = this.app.workspace.getActiveFile();
    if (file == null) {
      return;
    }
    this.app.fileManager.processFrontMatter(file, (fm) => {
      let tags = (0, import_obsidian.parseFrontMatterTags)(fm);
      if (tags == null) {
        tags = ["#inbox"];
      } else if (!tags.includes("#inbox")) {
        tags.push("#inbox");
      } else {
        tags = tags.filter((x) => x !== "#inbox");
      }
      fm.tags = tags;
      return fm;
    });
  }
  async copy_markdown() {
    let file = this.app.workspace.getActiveFile();
    if (file == null) {
      return;
    }
    let contents = await this.app.vault.cachedRead(file);
    contents = contents.replace(/^---[\s\S]*?---/, "");
    contents = contents.replace(/^[\s\S]*%%\s*?\-\-\-\s*?%%/, "");
    contents = contents.replace(/\[\[(.*?)\|(.*?)\]\]/g, "$2");
    contents = contents.replace(/\[\[(.*?)\]\]/g, "$1");
    contents = contents.replace(/%%[\s\S]*?%%/g, "");
    contents = contents.replace(/^\s*/, "");
    contents = contents.replace(/\s*$/, "");
    await navigator.clipboard.writeText(contents);
    new import_obsidian.Notice(contents);
  }
  open_inbox_note() {
    const files = this.app.vault.getMarkdownFiles();
    let inboxFiles = [];
    for (const file of files) {
      const mc = this.app.metadataCache.getFileCache(file);
      if (mc == null) {
        continue;
      }
      let tags = (0, import_obsidian.getAllTags)(mc);
      if (tags == null) {
        continue;
      }
      if (tags.includes("#inbox") && file.path.search("Templates") == -1) {
        inboxFiles.push(file);
      }
    }
    let folder = this.app.vault.getAbstractFileByPath(INBOX_PATH);
    if (folder instanceof import_obsidian.TFolder) {
      console.log("here 1");
      for (const f of folder.children) {
        if (f instanceof import_obsidian.TFile) {
          inboxFiles.push(f);
        }
      }
    } else {
      console.log("here");
    }
    inboxFiles.sort((a, b) => {
      const aIsMarkdown = a.extension === "md";
      const bIsMarkdown = b.extension === "md";
      if (aIsMarkdown && !bIsMarkdown)
        return -1;
      if (!aIsMarkdown && bIsMarkdown)
        return 1;
      return b.stat.ctime - a.stat.ctime;
    });
    if (inboxFiles.length == 0) {
      return;
    }
    let index = 0;
    let activeFile = this.app.workspace.getActiveFile();
    if (activeFile !== null) {
      index = inboxFiles.findIndex((obj) => obj == activeFile);
      if (index < 0) {
        index = -1;
      }
      index = (index + 1) % inboxFiles.length;
    }
    this.app.workspace.getLeaf().openFile(inboxFiles[index]);
  }
  async unique_note() {
    const file = this.app.vault.getMarkdownFiles().find(
      (f) => f.basename == BASIC_TEMPLATE
    );
    if (file == null) {
      console.log("Can't find: ", BASIC_TEMPLATE);
      return null;
    }
    let stamp = Math.random().toString(36).substring(9).toUpperCase();
    let name = `${currentDate()} ${stamp}.md`;
    let contents = await this.unique_note_contents();
    let newFile = await this.app.vault.create(name, contents);
    await this.app.workspace.getLeaf().openFile(newFile);
    const view = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
    if (view == null) {
      return;
    }
    view.editor.focus();
  }
  delete_inbox() {
    let file = this.app.workspace.getActiveFile();
    this.open_inbox_note();
    if (file !== null) {
      this.app.vault.trash(file, false);
    }
  }
  async onload() {
    const inbox_next_cb = () => this.open_inbox_note();
    this.addCommand({
      id: "ethan:inbox-next",
      name: "Next inbox",
      callback: inbox_next_cb
    });
    this.addRibbonIcon("mails", "Next", inbox_next_cb);
    const new_note_cb = () => this.unique_note();
    this.addCommand({
      id: "ethan:unique-note",
      name: "New note",
      callback: new_note_cb
    });
    this.addRibbonIcon("file-plus-2", "Create", new_note_cb);
    const delete_inbox_cb = () => this.delete_inbox();
    this.addCommand({
      id: "ethan:delete-inbox-next",
      name: "Delete",
      callback: delete_inbox_cb
    });
    this.addRibbonIcon("trash", "Delete", delete_inbox_cb);
    const copy_markdown_cb = () => this.copy_markdown();
    this.addCommand({
      id: "ethan:copy-markdown",
      name: "Copy markdown",
      callback: copy_markdown_cb
    });
    this.addRibbonIcon("clipboard-copy", "Copy", copy_markdown_cb);
    this.addCommand({
      id: "ethan:toggle-inbox",
      name: "Toggle inbox",
      callback: () => this.toggle_inbox()
    });
    this.addCommand({
      id: "ethan:append-task",
      name: "Append Task",
      callback: () => this.append_task()
    });
    this.addCommand({
      id: "ethan:create-task",
      name: "Create Task",
      callback: () => this.create_task()
    });
    this.app.workspace.onLayoutReady(() => {
      this.registerEvent(this.app.vault.on("create", this.on_create, this));
    });
  }
  onunload() {
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgUGx1Z2luLCBBcHAsIE1hcmtkb3duVmlldywgTm90aWNlLCBnZXRBbGxUYWdzLCBwYXJzZUZyb250TWF0dGVyVGFncywgVEZvbGRlciwgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5cbmNvbnN0IEJBU0lDX1RFTVBMQVRFID0gXCJCYXNpYyBUZW1wbGF0ZVwiO1xuY29uc3QgSU5CT1hfUEFUSCA9IFwiSW5ib3hcIjtcbmNvbnN0IFRBU0tTX1BBVEggPSBcIlRhc2tzLm1kXCI7XG5cbmZ1bmN0aW9uIGN1cnJlbnREYXRlKCkge1xuXHRyZXR1cm4gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNsaWNlKDAsIDEwKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRXRoYW5VdGlsIGV4dGVuZHMgUGx1Z2luIHtcblx0YXN5bmMgdW5pcXVlX25vdGVfY29udGVudHMoKSB7XG5cdFx0Y29uc3QgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKS5maW5kKFxuXHRcdFx0ZiA9PiBmLmJhc2VuYW1lID09IEJBU0lDX1RFTVBMQVRFKTtcblxuXHRcdGlmIChmaWxlID09IG51bGwpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihcIkNhbid0IGZpbmQ6IFwiICsgQkFTSUNfVEVNUExBVEUpO1xuXHRcdH1cblxuXHRcdGxldCBjb250ZW50cyA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNhY2hlZFJlYWQoZmlsZSk7XG5cdFx0Y29udGVudHMgPSBjb250ZW50cy5yZXBsYWNlKC97e2RhdGV9fS9nLCBjdXJyZW50RGF0ZSgpKTtcblxuXHRcdHJldHVybiBjb250ZW50c1xuXHR9XG5cblx0YXN5bmMgb25fY3JlYXRlKGZpbGU6IFRGaWxlKSB7XG5cdFx0Y29uc3QgbmV3X2NvbnRlbnRzID0gYXdhaXQgdGhpcy51bmlxdWVfbm90ZV9jb250ZW50cygpO1xuXG5cdFx0Ly8gVGhpcyBpcyBhIGJpdCBvZiBhIGhhY2sgdG8gcmVzb2x2ZSBhbiBpc3N1ZSBvbiBtb2JpbGUuICBXaGVuIHlvdVxuXHRcdC8vIHNoYXJlIHRvIG9ic2lkaWFuIGFuZCBjcmVhdGUgYSBuZXcgZmlsZSwgb2JzaWRpYW4gd2lsbCBjcmVhdGUgdGhlIGZpbGVcblx0XHQvLyBhbmQgdGhlbiB1c2UgbW9kaWZ5IHRvIHJlcGxhY2UgaXRzIGNvbnRlbnRzLiAgSWYgd2UgcnVuXG5cdFx0Ly8gY29uY3VycmVudGx5LCB3ZSBjb3VsZCByZWFkIHRoZSBlbXB0eSBjb250ZW50cyBvZiB0aGUgZmlsZSwgYW5kIHRoZW5cblx0XHQvLyBvdmVyd3JpdGUgd2hhdGV2ZXIgdGhleSBkaWQuICAgVG8gcmVzb2x2ZSB0aGlzLCB3ZSByZWFkIG91ciB0ZW1wbGF0ZSxcblx0XHQvLyBhbmQgdGhlbiBzbGVlcCBmb3IgMTBtcy4gIFRoYXQgZ2l2ZXMganVzdCBlbm91Z2ggYnVmZmVyIHRvIGVuc3VyZSB0aGF0XG5cdFx0Ly8gd2UncmUgbm90IGNsb2JiZXJpbmcgdGhlIHNoYXJlLlxuXHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMCkpO1xuXG5cdFx0Y29uc3Qgb2xkX2NvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuXG5cdFx0Ly8gSWYgaXQgc3RhcnRzIHdpdGggZnJvbnRtYXR0ZXIsIGRvbid0IGFkZCBvdXIgdGVtcGxhdGVcblx0XHRpZiAoL14tLS0vLnRlc3Qob2xkX2NvbnRlbnQpKSB7XG5cdFx0XHRyZXR1cm5cblx0XHR9XG5cblx0XHR0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3X2NvbnRlbnRzICsgb2xkX2NvbnRlbnQpXG5cdH1cblxuXHRhc3luYyBjcmVhdGVfdGFzaygpIHtcblx0XHRjb25zdCBwbHVnaW4gPSB0aGlzLmFwcC5wbHVnaW5zLnBsdWdpbnNbJ29ic2lkaWFuLXRhc2tzLXBsdWdpbiddXG5cdFx0Y29uc3QgdGFzayA9IGF3YWl0IHBsdWdpbi5hcGlWMS5jcmVhdGVUYXNrTGluZU1vZGFsKCk7XG5cdFx0Y29uc3QgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChUQVNLU19QQVRIKTtcblxuXHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcblx0XHRcdHRoaXMuYXBwLnZhdWx0LmFwcGVuZChmaWxlLCBcIlxcblwiICsgdGFzayk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiZmFpbGVkIHRvIGZpbmQgZmlsZSBmb3IgY3JlYXRlX3Rhc2tcIilcblx0XHR9XG5cdH1cblxuXHRhc3luYyBhcHBlbmRfdGFzaygpIHtcblx0XHRjb25zdCBlZGl0b3IgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpPy5lZGl0b3I7XG5cdFx0aWYgKGVkaXRvciA9PSBudWxsKSB7XG5cdFx0XHRyZXR1cm5cblx0XHR9XG5cblx0XHRjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG5cdFx0Y29uc3QgbGluZUNvbnRlbnQgPSBlZGl0b3IuZ2V0TGluZShjdXJzb3IubGluZSk7XG5cblx0XHRlZGl0b3IucmVwbGFjZVJhbmdlKFwiXCIsXG5cdFx0XHR7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogMCB9LFxuXHRcdFx0eyBsaW5lOiBjdXJzb3IubGluZSArIDEsIGNoOiAwIH0pO1xuXG5cdFx0Y29uc3QgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChUQVNLU19QQVRIKTtcblx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG5cdFx0XHRhd2FpdCB0aGlzLmFwcC52YXVsdC5hcHBlbmQoZmlsZSwgXCJcXG5cIiArIGxpbmVDb250ZW50KTtcblx0XHR9XG5cdH1cblxuXHR0b2dnbGVfaW5ib3goKSB7XG5cdFx0bGV0IGZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdGlmIChmaWxlID09IG51bGwpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR0aGlzLmFwcC5maWxlTWFuYWdlci5wcm9jZXNzRnJvbnRNYXR0ZXIoZmlsZSwgKGZtOiBhbnkpID0+IHtcblx0XHRcdGxldCB0YWdzID0gcGFyc2VGcm9udE1hdHRlclRhZ3MoZm0pO1xuXG5cdFx0XHRpZiAodGFncyA9PSBudWxsKSB7XG5cdFx0XHRcdHRhZ3MgPSBbXCIjaW5ib3hcIl07XG5cdFx0XHR9IGVsc2UgaWYgKCF0YWdzLmluY2x1ZGVzKFwiI2luYm94XCIpKSB7XG5cdFx0XHRcdHRhZ3MucHVzaChcIiNpbmJveFwiKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRhZ3MgPSB0YWdzLmZpbHRlcigoeDogc3RyaW5nKSA9PiB4ICE9PSBcIiNpbmJveFwiKTtcblx0XHRcdH1cblx0XHRcdGZtLnRhZ3MgPSB0YWdzO1xuXHRcdFx0cmV0dXJuIGZtO1xuXHRcdH0pO1xuXHR9XG5cblx0YXN5bmMgY29weV9tYXJrZG93bigpIHtcblx0XHRsZXQgZmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0aWYgKGZpbGUgPT0gbnVsbCkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGxldCBjb250ZW50cyA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNhY2hlZFJlYWQoZmlsZSk7XG5cdFx0Y29udGVudHMgPSBjb250ZW50cy5yZXBsYWNlKC9eLS0tW1xcc1xcU10qPy0tLS8sIFwiXCIpO1xuXHRcdGNvbnRlbnRzID0gY29udGVudHMucmVwbGFjZSgvXltcXHNcXFNdKiUlXFxzKj9cXC1cXC1cXC1cXHMqPyUlLywgXCJcIik7XG5cdFx0Y29udGVudHMgPSBjb250ZW50cy5yZXBsYWNlKC9cXFtcXFsoLio/KVxcfCguKj8pXFxdXFxdL2csIFwiJDJcIik7XG5cdFx0Y29udGVudHMgPSBjb250ZW50cy5yZXBsYWNlKC9cXFtcXFsoLio/KVxcXVxcXS9nLCBcIiQxXCIpO1xuXHRcdGNvbnRlbnRzID0gY29udGVudHMucmVwbGFjZSgvJSVbXFxzXFxTXSo/JSUvZywgXCJcIik7XG5cdFx0Y29udGVudHMgPSBjb250ZW50cy5yZXBsYWNlKC9eXFxzKi8sIFwiXCIpO1xuXHRcdGNvbnRlbnRzID0gY29udGVudHMucmVwbGFjZSgvXFxzKiQvLCBcIlwiKTtcblxuXHRcdGF3YWl0IG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KGNvbnRlbnRzKTtcblx0XHRuZXcgTm90aWNlKGNvbnRlbnRzKTtcblx0fVxuXG5cdG9wZW5faW5ib3hfbm90ZSgpIHtcblx0XHRjb25zdCBmaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcblxuXHRcdGxldCBpbmJveEZpbGVzID0gW107XG5cdFx0Zm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG5cdFx0XHRjb25zdCBtYyA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuXHRcdFx0aWYgKG1jID09IG51bGwpIHtcblx0XHRcdFx0Y29udGludWU7XG5cdFx0XHR9XG5cblx0XHRcdGxldCB0YWdzID0gZ2V0QWxsVGFncyhtYyk7XG5cdFx0XHRpZiAodGFncyA9PSBudWxsKSB7XG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAodGFncy5pbmNsdWRlcyhcIiNpbmJveFwiKVxuXHRcdFx0XHQmJiBmaWxlLnBhdGguc2VhcmNoKFwiVGVtcGxhdGVzXCIpID09IC0xKSB7XG5cdFx0XHRcdGluYm94RmlsZXMucHVzaChmaWxlKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRsZXQgZm9sZGVyID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKElOQk9YX1BBVEgpO1xuXHRcdGlmIChmb2xkZXIgaW5zdGFuY2VvZiBURm9sZGVyKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcImhlcmUgMVwiKVxuXHRcdFx0Zm9yIChjb25zdCBmIG9mIGZvbGRlci5jaGlsZHJlbikge1xuXHRcdFx0XHRpZiAoZiBpbnN0YW5jZW9mIFRGaWxlKSB7XG5cdFx0XHRcdFx0aW5ib3hGaWxlcy5wdXNoKGYpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiaGVyZVwiKVxuXHRcdH1cblxuXHRcdGluYm94RmlsZXMuc29ydCgoYSwgYikgPT4ge1xuXHRcdFx0Ly8gQ2hlY2sgaWYgZmlsZXMgYXJlIG1hcmtkb3duXG5cdFx0XHRjb25zdCBhSXNNYXJrZG93biA9IGEuZXh0ZW5zaW9uID09PSAnbWQnO1xuXHRcdFx0Y29uc3QgYklzTWFya2Rvd24gPSBiLmV4dGVuc2lvbiA9PT0gJ21kJztcblxuXHRcdFx0Ly8gSWYgb25lIGlzIG1hcmtkb3duIGFuZCB0aGUgb3RoZXIgaXNuJ3QsIHByaW9yaXRpemUgbWFya2Rvd25cblx0XHRcdGlmIChhSXNNYXJrZG93biAmJiAhYklzTWFya2Rvd24pIHJldHVybiAtMTtcblx0XHRcdGlmICghYUlzTWFya2Rvd24gJiYgYklzTWFya2Rvd24pIHJldHVybiAxO1xuXG5cdFx0XHQvLyBJZiBib3RoIGFyZSBtYXJrZG93biBvciBib3RoIGFyZSBub3QsIHNvcnQgYnkgY3JlYXRpb24gdGltZVxuXHRcdFx0cmV0dXJuIGIuc3RhdC5jdGltZSAtIGEuc3RhdC5jdGltZTtcblx0XHR9KTtcblxuXHRcdGlmIChpbmJveEZpbGVzLmxlbmd0aCA9PSAwKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0bGV0IGluZGV4ID0gMDtcblx0XHRsZXQgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0aWYgKGFjdGl2ZUZpbGUgIT09IG51bGwpIHtcblx0XHRcdGluZGV4ID0gaW5ib3hGaWxlcy5maW5kSW5kZXgob2JqID0+IG9iaiA9PSBhY3RpdmVGaWxlKTsgLy8gV2Ugd2FudCB0aGUgbmV4dCBmaWxlLlxuXHRcdFx0aWYgKGluZGV4IDwgMCkge1xuXHRcdFx0XHRpbmRleCA9IC0xO1xuXHRcdFx0fVxuXHRcdFx0aW5kZXggPSAoaW5kZXggKyAxKSAlIGluYm94RmlsZXMubGVuZ3RoO1xuXHRcdH1cblxuXHRcdHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKCkub3BlbkZpbGUoaW5ib3hGaWxlc1tpbmRleF0pO1xuXHR9XG5cblx0YXN5bmMgdW5pcXVlX25vdGUoKSB7XG5cdFx0Y29uc3QgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKS5maW5kKFxuXHRcdFx0ZiA9PiBmLmJhc2VuYW1lID09IEJBU0lDX1RFTVBMQVRFKTtcblxuXHRcdGlmIChmaWxlID09IG51bGwpIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiQ2FuJ3QgZmluZDogXCIsIEJBU0lDX1RFTVBMQVRFKTtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblxuXHRcdGxldCBzdGFtcCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZyg5KS50b1VwcGVyQ2FzZSgpO1xuXHRcdGxldCBuYW1lID0gYCR7Y3VycmVudERhdGUoKX0gJHtzdGFtcH0ubWRgO1xuXHRcdGxldCBjb250ZW50cyA9IGF3YWl0IHRoaXMudW5pcXVlX25vdGVfY29udGVudHMoKTtcblx0XHRsZXQgbmV3RmlsZSA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShuYW1lLCBjb250ZW50cyk7XG5cdFx0YXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoKS5vcGVuRmlsZShuZXdGaWxlKTtcblxuXHRcdGNvbnN0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRcdGlmICh2aWV3ID09IG51bGwpIHtcblx0XHRcdHJldHVyblxuXHRcdH1cblx0XHR2aWV3LmVkaXRvci5mb2N1cygpO1xuXHR9XG5cblx0ZGVsZXRlX2luYm94KCkge1xuXHRcdGxldCBmaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHR0aGlzLm9wZW5faW5ib3hfbm90ZSgpO1xuXHRcdGlmIChmaWxlICE9PSBudWxsKSB7XG5cdFx0XHR0aGlzLmFwcC52YXVsdC50cmFzaChmaWxlLCBmYWxzZSk7XG5cdFx0fVxuXHR9XG5cblx0YXN5bmMgb25sb2FkKCkge1xuXHRcdC8vIEljb24gTmFtZXMgY29tZSBmcm9tOiBodHRwczovL2x1Y2lkZS5kZXYvXG5cdFx0Y29uc3QgaW5ib3hfbmV4dF9jYiA9ICgpID0+IHRoaXMub3Blbl9pbmJveF9ub3RlKClcblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6ICdldGhhbjppbmJveC1uZXh0Jyxcblx0XHRcdG5hbWU6ICdOZXh0IGluYm94Jyxcblx0XHRcdGNhbGxiYWNrOiBpbmJveF9uZXh0X2NiLFxuXHRcdH0pO1xuXHRcdHRoaXMuYWRkUmliYm9uSWNvbihcIm1haWxzXCIsIFwiTmV4dFwiLCBpbmJveF9uZXh0X2NiKTtcblxuXHRcdGNvbnN0IG5ld19ub3RlX2NiID0gKCkgPT4gdGhpcy51bmlxdWVfbm90ZSgpXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiAnZXRoYW46dW5pcXVlLW5vdGUnLFxuXHRcdFx0bmFtZTogJ05ldyBub3RlJyxcblx0XHRcdGNhbGxiYWNrOiBuZXdfbm90ZV9jYixcblx0XHR9KTtcblx0XHR0aGlzLmFkZFJpYmJvbkljb24oXCJmaWxlLXBsdXMtMlwiLCBcIkNyZWF0ZVwiLCBuZXdfbm90ZV9jYik7XG5cblx0XHRjb25zdCBkZWxldGVfaW5ib3hfY2IgPSAoKSA9PiB0aGlzLmRlbGV0ZV9pbmJveCgpXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiAnZXRoYW46ZGVsZXRlLWluYm94LW5leHQnLFxuXHRcdFx0bmFtZTogJ0RlbGV0ZScsXG5cdFx0XHRjYWxsYmFjazogZGVsZXRlX2luYm94X2NiLFxuXHRcdH0pO1xuXHRcdHRoaXMuYWRkUmliYm9uSWNvbihcInRyYXNoXCIsIFwiRGVsZXRlXCIsIGRlbGV0ZV9pbmJveF9jYik7XG5cblx0XHRjb25zdCBjb3B5X21hcmtkb3duX2NiID0gKCkgPT4gdGhpcy5jb3B5X21hcmtkb3duKClcblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6ICdldGhhbjpjb3B5LW1hcmtkb3duJyxcblx0XHRcdG5hbWU6ICdDb3B5IG1hcmtkb3duJyxcblx0XHRcdGNhbGxiYWNrOiBjb3B5X21hcmtkb3duX2NiLFxuXHRcdH0pO1xuXHRcdHRoaXMuYWRkUmliYm9uSWNvbihcImNsaXBib2FyZC1jb3B5XCIsIFwiQ29weVwiLCBjb3B5X21hcmtkb3duX2NiKTtcblxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRpZDogJ2V0aGFuOnRvZ2dsZS1pbmJveCcsXG5cdFx0XHRuYW1lOiAnVG9nZ2xlIGluYm94Jyxcblx0XHRcdGNhbGxiYWNrOiAoKSA9PiB0aGlzLnRvZ2dsZV9pbmJveCgpXG5cdFx0fSk7XG5cblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6ICdldGhhbjphcHBlbmQtdGFzaycsXG5cdFx0XHRuYW1lOiAnQXBwZW5kIFRhc2snLFxuXHRcdFx0Y2FsbGJhY2s6ICgpID0+IHRoaXMuYXBwZW5kX3Rhc2soKVxuXHRcdH0pO1xuXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiAnZXRoYW46Y3JlYXRlLXRhc2snLFxuXHRcdFx0bmFtZTogJ0NyZWF0ZSBUYXNrJyxcblx0XHRcdGNhbGxiYWNrOiAoKSA9PiB0aGlzLmNyZWF0ZV90YXNrKClcblx0XHR9KTtcblxuXHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbkxheW91dFJlYWR5KCgpID0+IHtcblx0XHRcdHRoaXMucmVnaXN0ZXJFdmVudCh0aGlzLmFwcC52YXVsdC5vbignY3JlYXRlJywgdGhpcy5vbl9jcmVhdGUsIHRoaXMpKTtcblx0XHR9KTtcblxuXHR9XG5cblx0b251bmxvYWQoKSB7IH1cbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7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
